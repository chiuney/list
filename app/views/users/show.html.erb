<% provide(:title, "#{@user.user_name}") %>

<main class="mypage-container">
  <section class="mypage-content">

    <%= render partial: 'shared/flash' %>

    <div class="mypage-content__mypage-icon">
      <% if @user.persisted? && @user.image? %>
        <%= image_tag @user.image.thumb.url, class:"mypage-content__mypage-icon--image" %>
      <% else %>
        <%= image_tag 'no-image.png',class:"mypage-content__mypage-icon--image" %>
      <% end %>
    </div>
    
    <div class="test">
      <p class="mypage-content__mypage-name"><%= @user.user_name %></p>
      <div class="mypage-content__mypage-info">
        <% unless @user == current_user %>
          <div class="follow-item__follow-btn">
            <% if current_user.following?(@user) %>
              <%= link_to 'フォローをやめる', unfollow_path(@user.id), method: :POST, class:"follow-item__follow-btn--unfollow" %>
            <% else %>
              <%= link_to 'フォローする', follow_path(@user.id), method: :POST,class:"follow-item__follow-btn--following" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>

    <p class="mypage-content__mypage-comment"><%= @user.user_comment %></p>
    
    <div class="mypage-content__maypage-follow" >
      <%= link_to "フォロー数: #{@user.follower.count}",   following_path(id: @user.id),class:"mypage-content__maypage-follow--link" %>
      <%= link_to "フォロワー数: #{@user.followed.count}", followers_path(id: @user.id), class:"mypage-content__maypage-follow--link" %>
    </div>
  </section>
  
  <section class="item-display">
    <div class="item-array" >
      <div class="item-array__item-detail">
        <%= link_to image_tag("no-image.png", class:"item-array__item-detail--img"), add_shops_index_path %>
        <%= link_to "全てのお店", add_shops_index_path, class:"item-array__item-detail--name" %>
        <%= link_to "店舗 : #{@add_shops.size}件", add_shops_index_path, class:"item-array__item-detail--size" %>
      </div>

      <% @lists.each do |l| %>
        <div class="item-array__item-detail">

          <% if l.shops.present? %>
            <% if l.shops[0].photos[0].present? %>
              <%= link_to image_tag(l.shops[0].photos[0],class:"item-array__item-detail--img"), list_path(l.id) %>
              <% else %>
              <%= link_to image_tag("no-image.png", class:"item-array__item-detail--img"), list_path(l.id) %>
            <% end %>
          <% else %>
            <%= link_to image_tag("no-image.png", class:"item-array__item-detail--img"), list_path(l.id) %>
          <% end %>

          <%= link_to l.list_name, list_path(l.id), class:"item-array__item-detail--name" %>
          <%= link_to "店舗 : #{l.shops.size}件", list_path(l.id), class:"item-array__item-detail--size" %>
        </div>
      <% end %>
    </div>
  </section>

<main>